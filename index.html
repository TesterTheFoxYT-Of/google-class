<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Game Launcher | google-class</title>
  <style>
    * { box-sizing: border-box; }
    body {
      margin: 0;
      display: flex;
      height: 100vh;
      background: #0e0e0e;
      color: #fff;
      font-family: "Segoe UI", sans-serif;
      overflow: hidden;
    }
    #sidebar {
      width: 280px;
      background: #181818;
      border-right: 1px solid #333;
      display: flex;
      flex-direction: column;
    }
    #header {
      padding: 16px;
      text-align: center;
      font-weight: bold;
      font-size: 1.2em;
      background: linear-gradient(90deg, #5b00b5, #8a2be2);
      color: #fff;
    }
    #games-list {
      flex: 1;
      overflow-y: auto;
    }
    .game-item {
      padding: 12px 16px;
      border-bottom: 1px solid #2a2a2a;
      cursor: pointer;
      transition: background 0.2s;
    }
    .game-item:hover {
      background: #292929;
    }
    #content {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: #111;
    }
    iframe {
      flex: 1;
      border: none;
      background: #000;
    }
    #topbar {
      height: 48px;
      background: #1a1a1a;
      border-bottom: 1px solid #333;
      display: flex;
      align-items: center;
      padding: 0 12px;
    }
    #back-button {
      background: #333;
      color: #fff;
      border: none;
      border-radius: 8px;
      padding: 6px 12px;
      cursor: pointer;
      margin-right: 8px;
      display: none;
    }
    #game-title {
      font-weight: bold;
      color: #ccc;
    }
    #loading {
      text-align: center;
      padding: 20px;
      color: #888;
    }
  </style>
</head>
<body>
  <div id="sidebar">
    <div id="header">üéÆ –ò–≥—Ä—ã</div>
    <div id="games-list"><div id="loading">–ó–∞–≥—Ä—É–∑–∫–∞...</div></div>
  </div>
  <div id="content">
    <div id="topbar">
      <button id="back-button">‚Üê –ù–∞–∑–∞–¥</button>
      <span id="game-title">–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É</span>
    </div>
    <iframe id="game-frame"></iframe>
  </div>

  <script>
    const username = "TesterTheFoxYT-Of";
    const repo = "google-class";
    const branch = "main"; // –∏–∑–º–µ–Ω–∏, –µ—Å–ª–∏ —Ç–≤–æ—è –≤–µ—Ç–∫–∞ –Ω–µ main

    const gamesListEl = document.getElementById("games-list");
    const frame = document.getElementById("game-frame");
    const backBtn = document.getElementById("back-button");
    const titleEl = document.getElementById("game-title");

    async function loadGames() {
      try {
        const proxy = "https://api.allorigins.win/raw?url=";
        const apiUrl = `https://api.github.com/repos/${username}/${repo}/contents/`;
        const resp = await fetch(proxy + encodeURIComponent(apiUrl));
        const data = await resp.json();
        const folders = data.filter(item => item.type === "dir");

        const games = [];

        for (const folder of folders) {
          const innerResp = await fetch(proxy + encodeURIComponent(folder.url));
          const inner = await innerResp.json();
          const hasIndex = inner.find(f => f.name === "index.html");
          if (hasIndex) {
            games.push({
              title: folder.name,
              path: `https://${username}.github.io/${repo}/${folder.name}/index.html`
            });
          }
        }

        if (games.length === 0) {
          gamesListEl.innerHTML = "<div id='loading'>–ò–≥—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</div>";
          return;
        }

        renderList(games);
      } catch (err) {
        console.error(err);
        gamesListEl.innerHTML = "<div id='loading'>–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å–ø–∏—Å–∫–∞ –∏–≥—Ä.</div>";
      }
    }

    function renderList(games) {
      gamesListEl.innerHTML = "";
      games.forEach(g => {
        const item = document.createElement("div");
        item.classList.add("game-item");
        item.textContent = g.title;
        item.onclick = () => launchGame(g);
        gamesListEl.appendChild(item);
      });
    }

    function launchGame(game) {
      frame.src = game.path;
      titleEl.textContent = game.title;
      backBtn.style.display = "inline-block";
    }

    backBtn.onclick = () => {
      frame.src = "";
      titleEl.textContent = "–í—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É";
      backBtn.style.display = "none";
    };

    loadGames();
  </script>
</body>
</html>
